# Unified Photo Booth

Объединенное приложение фотобудки и видеобудки на C# и WPF с интеграцией Google Drive.

## Описание

Unified Photo Booth - это современное приложение для создания фотобудки и видеобудки на базе WPF. Приложение позволяет делать серии фотографий с созданием коллажей и записывать видео с наложением оверлеев. Все материалы автоматически загружаются в Google Drive с генерацией QR-кодов для быстрого доступа.

## Версия

Текущая версия: 0.0.1

## Системные требования

- **Операционная система**: Windows 10/11 (x64)
- **Платформа**: .NET 8.0
- **Камера**: Веб-камера с поддержкой DirectShow
- **Микрофон**: Для записи видео с аудио
- **Место на диске**: Минимум 500 МБ свободного места

## Зависимости

Проект использует следующие NuGet пакеты:

- **OpenCvSharp4** (4.8.0.20230708) - библиотека компьютерного зрения для работы с камерой и обработки изображений
- **OpenCvSharp4.Extensions** - расширения для OpenCV
- **OpenCvSharp4.WpfExtensions** - интеграция OpenCV с WPF
- **OpenCvSharp4.runtime.win** - нативные библиотеки для Windows
- **Google.Apis.Drive.v3** (1.61.0.3155) - API для работы с Google Drive
- **NAudio** (2.2.1) - библиотека для записи и воспроизведения аудио
- **QRCoder** (1.6.0) - генерация QR-кодов
- **ZXing.Net** (0.16.9) - работа с QR-кодами
- **System.Drawing.Common** (8.0.0) - работа с изображениями

## Сборка приложения

Для сборки приложения используйте следующую команду:

```bash
dotnet publish UnifiedPhotoBooth.csproj -c Release -r win-x64 --self-contained true -o ./publish_full
```

Эта команда создаст самодостаточную сборку для Windows x64 в папке `publish_full`.

## Дополнительные файлы для развертывания

После сборки в папку `publish_full` необходимо добавить:

1. **API ключ Google Drive** - файл `photoboothproject-459010-c725b2899f7f.json` (JSON ключ сервисного аккаунта Google)
2. **FFmpeg** - исполняемый файл `ffmpeg.exe` для обработки видео с аудио

## Установка

1. Выполните сборку приложения с помощью команды выше
2. Скопируйте в папку `publish_full`:
   - JSON файл с ключом Google Drive API
   - Исполняемый файл `ffmpeg.exe`
3. Запустите `UnifiedPhotoBooth.exe`

## Функциональность

### Основные возможности

- **Переключение режимов**: Фотобудка и видеобудка в одном приложении
- **Управление событиями**: Создание и выбор событий для организации контента
- **Гибкие настройки**: Настройка камеры, поворота, зеркалирования
- **Полноэкранный режим**: Для использования в качестве терминала
- **Интеграция с Google Drive**: Автоматическая загрузка с QR-кодами

### Режим фотобудки

- **Серийная съемка**: От 1 до 4 фотографий с обратным отсчетом
- **Создание коллажей**: Автоматическое создание коллажа с настраиваемыми шаблонами
- **Обработка изображений**: Поворот, зеркалирование, обрезка
- **Печать**: Прямая печать коллажей на принтере
- **Шаблоны**: Поддержка пользовательских шаблонов с текстом и позиционированием

### Режим видеобудки

- **Запись видео**: Запись с камеры и микрофона одновременно
- **Оверлеи**: Наложение графических элементов на видео
- **Обработка видео**: Автоматическое склеивание видео и аудио через FFmpeg
- **Воспроизведение**: Просмотр записанного видео с элементами управления
- **Конвертация**: Автоматическая конвертация в MP4 формат

### Галерея

- **Просмотр содержимого**: Просмотр всех созданных фотографий и видео
- **Организация по событиям**: Фильтрация контента по событиям
- **Быстрый доступ**: Открытие файлов в стандартных приложениях

## Настройка Google Drive

Для работы с Google Drive необходимо:

1. **Создать проект** в Google Cloud Console
2. **Включить Google Drive API** для проекта
3. **Создать сервисный аккаунт** и скачать JSON ключ
4. **Переименовать файл** ключа в `photoboothproject-459010-c725b2899f7f.json`
5. **Поместить файл** в папку с приложением
6. **Создать папки** на Google Drive:
   - Папка для событий (ID указать в `GoogleDriveService.cs` в константе `EVENTS_FOLDER_ID`)
   - Папка для универсальных ссылок (ID указать в константе `UNIVERSAL_FOLDER_ID`)

## Настройки приложения

Приложение сохраняет настройки в файле конфигурации и предоставляет интерфейс для изменения:

- **Индекс камеры**: Выбор камеры при наличии нескольких
- **Режим поворота**: Поворот изображения на 90°, 180° или без поворота
- **Зеркальный режим**: Горизонтальное отражение изображения
- **Режим обработки фото**: Различные способы обрезки и масштабирования
- **Таймер съемки**: Настройка времени обратного отсчета

## Структура проекта

```
UnifiedPhotoBooth/
├── MainWindow.xaml[.cs]      # Главное окно приложения
├── PhotoBoothPage.xaml[.cs]  # Страница фотобудки
├── VideoBoothPage.xaml[.cs]  # Страница видеобудки
├── GalleryPage.xaml[.cs]     # Страница галереи
├── SettingsWindow.xaml[.cs]  # Окно настроек
├── GoogleDriveService.cs     # Сервис для работы с Google Drive
├── SettingsManager.cs        # Управление настройками
├── App.xaml[.cs]            # Конфигурация приложения
├── photos/                   # Папка для сохранения фотографий
├── recordings/              # Папка для сохранения видео
├── Resources/               # Ресурсы приложения
└── publish_full/            # Папка сборки (создается командой publish)
```

## Известные проблемы

- Для корректной работы с видео требуется FFmpeg
- Первый запуск может требовать настройки индекса камеры
- Размер файлов видео зависит от настроек качества камеры

## Лицензия

Проект разработан для коммерческого использования.

## Авторы

- **Оригинальные скрипты**: photobooth.py и videobooth.py 
- **C# + WPF реализация**: Genius
- **Компания**: Unknown

## Поддержка

При возникновении проблем проверьте:
1. Правильность настройки Google Drive API
2. Наличие файла `ffmpeg.exe` в папке приложения
3. Корректность настроек камеры
4. Права доступа к папкам photos и recordings 